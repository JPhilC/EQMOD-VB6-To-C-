(%unit (%imports (%import "System") (%import "System.Runtime.InteropServices")) (%package "UpgradeSolution1Support.PInvoke.SafeNative" (%class "user32" (%public) (%static) (%method "GetForegroundWindow" (%int) (%args) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetForegroundWindow") (%param)))) (%public) (%shared)) (%method "GetMenuItemInfo" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "un") (%int)) (%variable (%byval) (%var "b") (%boolean)) (%variable (%byref) (%var "lpMenuItemInfo") (%user-type "UpgradeSolution1Support.PInvoke.UnsafeNative.Structures.MENUITEMINFO"))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetMenuItemInfo") (%param (%id "hMenu") (%id "un") (%id "b") (%ref-param (%id "lpMenuItemInfo")))))) (%public) (%shared)) (%method "GetSystemMenu" (%int) (%args (%variable (%byval) (%var "hwnd") (%int)) (%variable (%byval) (%var "bRevert") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetSystemMenu") (%param (%id "hwnd") (%id "bRevert"))))) (%public) (%shared)) (%method "GetSystemMetrics" (%int) (%args (%variable (%byval) (%var "nIndex") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetSystemMetrics") (%param (%id "nIndex"))))) (%public) (%shared)) (%method "IsWindow" (%int) (%args (%variable (%byval) (%var "hwnd") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.IsWindow") (%param (%id "hwnd"))))) (%public) (%shared)) (%method "PostMessage" (%int) (%args (%variable (%byval) (%var "hwnd") (%int)) (%variable (%byval) (%var "wMsg") (%int)) (%variable (%byval) (%var "wParam") (%int)) (%variable (%byval) (%var "lParam") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.PostMessage") (%param (%id "hwnd") (%id "wMsg") (%id "wParam") (%id "lParam"))))) (%public) (%shared)) (%method "SendMessage" (%int) (%args (%variable (%byval) (%var "hwnd") (%int)) (%variable (%byval) (%var "wMsg") (%int)) (%variable (%byval) (%var "wParam") (%int)) (%variable (%byref) (%var "lParam") (%int))) (%seq (%variable-list (%variable (%var "result" (%init-value 0)) (%int))) (%variable (%var "handle" (%init-value (%call (%id "GCHandle.Alloc") (%param (%id "lParam") (%id "GCHandleType.Pinned"))))) (%user-type "GCHandle")) (%try (%seq (%variable (%var "tmpPtr" (%init-value (%call (%dot (%id "handle") (%id "AddrOfPinnedObject")) (%param)))) (%user-type "IntPtr")) (%= (%id "result") (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SendMessage") (%param (%id "hwnd") (%id "wMsg") (%id "wParam") (%id "tmpPtr")))) (%= (%id "lParam") (%call (%id "Marshal.ReadInt16") (%param (%id "tmpPtr"))))) (%finally (%seq (%call (%dot (%id "handle") (%id "Free")) (%param))))) (%return (%id "result"))) (%public) (%shared)) (%method "SetMenuItemInfo" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "un") (%int)) (%variable (%byval) (%var "bool_Renamed") (%boolean)) (%variable (%byref) (%var "lpcMenuItemInfo") (%user-type "UpgradeSolution1Support.PInvoke.UnsafeNative.Structures.MENUITEMINFO"))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SetMenuItemInfo") (%param (%id "hMenu") (%id "un") (%id "bool_Renamed") (%ref-param (%id "lpcMenuItemInfo")))))) (%public) (%shared)) (%method "SetWindowPos" (%int) (%args (%variable (%byval) (%var "hwnd") (%int)) (%variable (%byval) (%var "hWndInsertAfter") (%int)) (%variable (%byval) (%var "x") (%int)) (%variable (%byval) (%var "Y") (%int)) (%variable (%byval) (%var "cx") (%int)) (%variable (%byval) (%var "cy") (%int)) (%variable (%byval) (%var "wFlags") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SetWindowPos") (%param (%id "hwnd") (%id "hWndInsertAfter") (%id "x") (%id "Y") (%id "cx") (%id "cy") (%id "wFlags"))))) (%public) (%shared)) (%method "SystemParametersInfo" (%boolean) (%args (%variable (%byval) (%var "uAction") (%int)) (%variable (%byval) (%var "uParam") (%int)) (%variable (%byref) (%var "lpvParam") (%boolean)) (%variable (%byval) (%var "fuWinIni") (%int))) (%seq (%variable-list (%variable (%var "result" (%init-value (%false))) (%boolean))) (%variable (%var "handle" (%init-value (%call (%id "GCHandle.Alloc") (%param (%id "lpvParam") (%id "GCHandleType.Pinned"))))) (%user-type "GCHandle")) (%try (%seq (%variable (%var "tmpPtr" (%init-value (%call (%dot (%id "handle") (%id "AddrOfPinnedObject")) (%param)))) (%user-type "IntPtr")) (%upgrade-todo 8007 "bool") (%= (%id "result") (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SystemParametersInfo") (%param (%id "uAction") (%id "uParam") (%id "tmpPtr") (%id "fuWinIni"))))) (%finally (%seq (%call (%dot (%id "handle") (%id "Free")) (%param))))) (%return (%id "result"))) (%public) (%shared)))))